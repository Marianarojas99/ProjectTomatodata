<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Stem diameter and dry anlysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Stem diameter and dry weight anlysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Stem diameter and dry weight anlysis_files/libs/quarto-html/quarto.js"></script>
<script src="Stem diameter and dry weight anlysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Stem diameter and dry weight anlysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Stem diameter and dry weight anlysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Stem diameter and dry weight anlysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Stem diameter and dry weight anlysis_files/libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Stem diameter and dry weight anlysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Stem diameter and dry weight anlysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Stem diameter and dry weight anlysis_files/libs/bootstrap/bootstrap-b8d30c7eeda119d43de224048e70de8f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Stem diameter and dry anlysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This report analyzes plant growth parameters, including stem diameter, aerial dry weight, and root dry weight. Statistical analysis methods are used to evaluate the effects of different treatments on these growth parameters.</p>
</section>
<section id="load-required-packages" class="level1">
<h1>Load required packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'agricolae' was built under R version 4.4.2</code></pre>
</div>
</div>
</section>
<section id="read-data" class="level1">
<h1>Read data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Data_4_SDiamDryWeight <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"DATA/tomato-clean.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"plants"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="select-required-columns" class="level1">
<h1>Select required columns</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Dfprov4_filtered <span class="ot">&lt;-</span> Data_4_SDiamDryWeight <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Treatment, <span class="st">`</span><span class="at">Stem diameter</span><span class="st">`</span>, <span class="st">`</span><span class="at">Aereal dry weight</span><span class="st">`</span>, <span class="st">`</span><span class="at">Root dry weight</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>select(Treatment, Stem diameter, Aereal dry weight, Root dry weight)</p>
</section>
<section id="convert-treatment-to-factor" class="level1">
<h1>Convert Treatment to factor</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Dfprov4_filtered<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Dfprov4_filtered<span class="sc">$</span>Treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="analysis-of-variance-anova" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-variance-anova">Analysis of Variance (ANOVA)</h2>
<section id="stem-diameter-analysis" class="level3">
<h3 class="anchored" data-anchor-id="stem-diameter-analysis">Stem Diameter Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>anova_stem <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">Stem diameter</span><span class="st">`</span> <span class="sc">~</span> Treatment, <span class="at">data =</span> Dfprov4_filtered)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANOVA for Stem Diameter:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANOVA for Stem Diameter:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(anova_stem))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Treatment    4  86.52  21.629   8.871 0.000274 ***
Residuals   20  48.76   2.438                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="aerial-dry-weight-analysis" class="level3">
<h3 class="anchored" data-anchor-id="aerial-dry-weight-analysis">Aerial Dry Weight Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>anova_aereal <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">Aereal dry weight</span><span class="st">`</span> <span class="sc">~</span> Treatment, <span class="at">data =</span> Dfprov4_filtered)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANOVA for Aereal Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANOVA for Aereal Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(anova_aereal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
Treatment    4  72740   18185   0.382  0.819
Residuals   20 952289   47614               </code></pre>
</div>
</div>
</section>
<section id="root-dry-weight-analysis" class="level3">
<h3 class="anchored" data-anchor-id="root-dry-weight-analysis">Root Dry Weight Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>anova_root <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">Root dry weight</span><span class="st">`</span> <span class="sc">~</span> Treatment, <span class="at">data =</span> Dfprov4_filtered)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ANOVA for Root Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANOVA for Root Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(anova_root))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
Treatment    4   1138     285    0.05  0.995
Residuals   20 112690    5635               </code></pre>
</div>
</div>
</section>
</section>
<section id="fisher-lsd-test" class="level2">
<h2 class="anchored" data-anchor-id="fisher-lsd-test">Fisher LSD Test</h2>
<section id="lsd-analysis-for-stem-diameter" class="level3">
<h3 class="anchored" data-anchor-id="lsd-analysis-for-stem-diameter">LSD Analysis for Stem Diameter</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>LSD_stem <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(anova_stem, <span class="st">"Treatment"</span>, <span class="at">p.adj=</span><span class="st">"none"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Fisher LSD result - Stem Diameter:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fisher LSD result - Stem Diameter:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LSD_stem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror Df     Mean       CV  t.value     LSD
  2.438249 20 19.11107 8.170603 2.085963 2.06004

$parameters
        test p.ajusted    name.t ntr alpha
  Fisher-LSD      none Treatment   5  0.05

$means
             Stem diameter       std r        se      LCL      UCL      Min
Control           20.21400 1.2663737 5 0.6983193 18.75733 21.67067 18.35333
EXAm              21.83467 0.3881266 5 0.6983193 20.37800 23.29134 21.41333
Infes             16.70667 1.0802957 5 0.6983193 15.25000 18.16334 14.97667
Infes+Captan      17.43133 2.8234540 5 0.6983193 15.97466 18.88800 12.79000
Infes+EXAm        19.36867 1.1392849 5 0.6983193 17.91200 20.82534 17.59667
                  Max      Q25      Q50      Q75
Control      21.85333 19.89333 20.39667 20.57333
EXAm         22.33667 21.47667 21.91667 22.03000
Infes        17.68000 16.52667 16.81667 17.53333
Infes+Captan 20.04333 16.91333 18.63333 18.77667
Infes+EXAm   20.76667 19.31000 19.57000 19.60000

$comparison
NULL

$groups
             Stem diameter groups
EXAm              21.83467      a
Control           20.21400     ab
Infes+EXAm        19.36867     bc
Infes+Captan      17.43133     cd
Infes             16.70667      d

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
</section>
<section id="lsd-analysis-for-aerial-dry-weight" class="level3">
<h3 class="anchored" data-anchor-id="lsd-analysis-for-aerial-dry-weight">LSD Analysis for Aerial Dry Weight</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>LSD_aereal <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(anova_aereal, <span class="st">"Treatment"</span>, <span class="at">p.adj=</span><span class="st">"none"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Fisher LSD result - Aereal Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fisher LSD result - Aereal Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LSD_aereal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror Df   Mean       CV  t.value      LSD
  47614.46 20 854.68 25.53089 2.085963 287.8764

$parameters
        test p.ajusted    name.t ntr alpha
  Fisher-LSD      none Treatment   5  0.05

$means
             Aereal dry weight      std r       se      LCL       UCL Min  Max
Control                  780.6 294.0728 5 97.58531 577.0406  984.1594 537 1275
EXAm                     848.6 213.7646 5 97.58531 645.0406 1052.1594 588 1135
Infes                    834.0 125.2537 5 97.58531 630.4406 1037.5594 694 1038
Infes+Captan             947.0 277.0217 5 97.58531 743.4406 1150.5594 775 1438
Infes+EXAm               863.2 116.0547 5 97.58531 659.6406 1066.7594 763 1038
             Q25 Q50 Q75
Control      611 669 811
EXAm         694 895 931
Infes        805 810 823
Infes+Captan 810 834 878
Infes+EXAm   775 818 922

$comparison
NULL

$groups
             Aereal dry weight groups
Infes+Captan             947.0      a
Infes+EXAm               863.2      a
EXAm                     848.6      a
Infes                    834.0      a
Control                  780.6      a

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
</section>
<section id="lsd-analysis-for-root-dry-weight" class="level3">
<h3 class="anchored" data-anchor-id="lsd-analysis-for-root-dry-weight">LSD Analysis for Root Dry Weight</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>LSD_root <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(anova_root, <span class="st">"Treatment"</span>, <span class="at">p.adj=</span><span class="st">"none"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Fisher LSD result - Root Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fisher LSD result - Root Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LSD_root)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df   Mean      CV  t.value      LSD
  5634.52 20 291.76 25.7278 2.085963 99.02963

$parameters
        test p.ajusted    name.t ntr alpha
  Fisher-LSD      none Treatment   5  0.05

$means
             Root dry weight      std r       se      LCL      UCL Min Max Q25
Control                282.0 81.20037 5 33.56939 211.9755 352.0245 182 364 227
EXAm                   300.2 61.82394 5 33.56939 230.1755 370.2245 237 398 260
Infes                  292.0 94.07444 5 33.56939 221.9755 362.0245 237 457 237
Infes+Captan           297.8 80.81893 5 33.56939 227.7755 367.8245 237 424 243
Infes+EXAm             286.8 48.73602 5 33.56939 216.7755 356.8245 221 333 251
             Q50 Q75
Control      274 363
EXAm         296 310
Infes        247 282
Infes+Captan 251 334
Infes+EXAm   304 325

$comparison
NULL

$groups
             Root dry weight groups
EXAm                   300.2      a
Infes+Captan           297.8      a
Infes                  292.0      a
Infes+EXAm             286.8      a
Control                282.0      a

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
</section>
<section id="visualize-results" class="level3">
<h3 class="anchored" data-anchor-id="visualize-results">Visualize results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LSD_stem)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LSD_aereal)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LSD_root)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stem-diameter-and-dry-weight-anlysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tukey-hsd-test" class="level2">
<h2 class="anchored" data-anchor-id="tukey-hsd-test">Tukey HSD Test</h2>
<section id="tukey-hsd-analysis-for-stem-diameter" class="level3">
<h3 class="anchored" data-anchor-id="tukey-hsd-analysis-for-stem-diameter">Tukey HSD Analysis for Stem Diameter</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tukey_stem <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_stem)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Tukey HSD result - Stem Diameter:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tukey HSD result - Stem Diameter:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_stem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = `Stem diameter` ~ Treatment, data = Dfprov4_filtered)

$Treatment
                              diff        lwr        upr     p adj
EXAm-Control             1.6206667 -1.3345205  4.5758538 0.4900906
Infes-Control           -3.5073333 -6.4625205 -0.5521462 0.0152452
Infes+Captan-Control    -2.7826667 -5.7378538  0.1725205 0.0710855
Infes+EXAm-Control      -0.8453333 -3.8005205  2.1098538 0.9094204
Infes-EXAm              -5.1280000 -8.0831871 -2.1728129 0.0003827
Infes+Captan-EXAm       -4.4033333 -7.3585205 -1.4481462 0.0020020
Infes+EXAm-EXAm         -2.4660000 -5.4211871  0.4891871 0.1310963
Infes+Captan-Infes       0.7246667 -2.2305205  3.6798538 0.9459589
Infes+EXAm-Infes         2.6620000 -0.2931871  5.6171871 0.0902646
Infes+EXAm-Infes+Captan  1.9373333 -1.0178538  4.8925205 0.3193005</code></pre>
</div>
</div>
</section>
<section id="tukey-hsd-analysis-for-aerial-dry-weight" class="level3">
<h3 class="anchored" data-anchor-id="tukey-hsd-analysis-for-aerial-dry-weight">Tukey HSD Analysis for Aerial Dry Weight</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tukey_aereal <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_aereal)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Tukey HSD result - Aereal Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tukey HSD result - Aereal Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_aereal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = `Aereal dry weight` ~ Treatment, data = Dfprov4_filtered)

$Treatment
                         diff      lwr     upr     p adj
EXAm-Control             68.0 -344.967 480.967 0.9871480
Infes-Control            53.4 -359.567 466.367 0.9948582
Infes+Captan-Control    166.4 -246.567 579.367 0.7481663
Infes+EXAm-Control       82.6 -330.367 495.567 0.9737011
Infes-EXAm              -14.6 -427.567 398.367 0.9999690
Infes+Captan-EXAm        98.4 -314.567 511.367 0.9510643
Infes+EXAm-EXAm          14.6 -398.367 427.567 0.9999690
Infes+Captan-Infes      113.0 -299.967 525.967 0.9217206
Infes+EXAm-Infes         29.2 -383.767 442.167 0.9995129
Infes+EXAm-Infes+Captan -83.8 -496.767 329.167 0.9722942</code></pre>
</div>
</div>
</section>
<section id="tukey-hsd-analysis-for-root-dry-weight" class="level3">
<h3 class="anchored" data-anchor-id="tukey-hsd-analysis-for-root-dry-weight">Tukey HSD Analysis for Root Dry Weight</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>tukey_root <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_root)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Tukey HSD result - Root Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tukey HSD result - Root Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_root)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = `Root dry weight` ~ Treatment, data = Dfprov4_filtered)

$Treatment
                         diff       lwr      upr     p adj
EXAm-Control             18.2 -123.8609 160.2609 0.9950380
Infes-Control            10.0 -132.0609 152.0609 0.9995214
Infes+Captan-Control     15.8 -126.2609 157.8609 0.9971250
Infes+EXAm-Control        4.8 -137.2609 146.8609 0.9999741
Infes-EXAm               -8.2 -150.2609 133.8609 0.9997818
Infes+Captan-EXAm        -2.4 -144.4609 139.6609 0.9999984
Infes+EXAm-EXAm         -13.4 -155.4609 128.6609 0.9984868
Infes+Captan-Infes        5.8 -136.2609 147.8609 0.9999449
Infes+EXAm-Infes         -5.2 -147.2609 136.8609 0.9999644
Infes+EXAm-Infes+Captan -11.0 -153.0609 131.0609 0.9993029</code></pre>
</div>
</div>
</section>
<section id="visualize-results-1" class="level3">
<h3 class="anchored" data-anchor-id="visualize-results-1">Visualize results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_stem)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Stem Diameter - Tukey HSD"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_aereal)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Aereal Dry Weight - Tukey HSD"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_root)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Root Dry Weight - Tukey HSD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stem-diameter-and-dry-weight-anlysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="normality-test" class="level2">
<h2 class="anchored" data-anchor-id="normality-test">Normality Test</h2>
<section id="shapiro-wilk-test-results" class="level3">
<h3 class="anchored" data-anchor-id="shapiro-wilk-test-results">Shapiro-Wilk Test Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>shapiro_stem <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Stem diameter</span><span class="st">`</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Normality Test - Stem Diameter:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Normality Test - Stem Diameter:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_stem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Dfprov4_filtered$`Stem diameter`
W = 0.94599, p-value = 0.2033</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>shapiro_aereal <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Aereal dry weight</span><span class="st">`</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Normality Test - Aereal Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Normality Test - Aereal Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_aereal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Dfprov4_filtered$`Aereal dry weight`
W = 0.91344, p-value = 0.03639</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>shapiro_root <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Root dry weight</span><span class="st">`</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Normality Test - Root Dry Weight:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Normality Test - Root Dry Weight:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_root)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Dfprov4_filtered$`Root dry weight`
W = 0.92799, p-value = 0.07811</code></pre>
</div>
</div>
</section>
<section id="q-q-plot-analysis" class="level3">
<h3 class="anchored" data-anchor-id="q-q-plot-analysis">Q-Q Plot Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Stem diameter</span><span class="st">`</span>, <span class="at">main=</span><span class="st">"Stem Diameter Q-Q Plot"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Stem diameter</span><span class="st">`</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Aereal dry weight</span><span class="st">`</span>, <span class="at">main=</span><span class="st">"Aereal Dry Weight Q-Q Plot"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Aereal dry weight</span><span class="st">`</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Root dry weight</span><span class="st">`</span>, <span class="at">main=</span><span class="st">"Root Dry Weight Q-Q Plot"</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(Dfprov4_filtered<span class="sc">$</span><span class="st">`</span><span class="at">Root dry weight</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stem-diameter-and-dry-weight-anlysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Based on the above analysis:</p>
<ol type="1">
<li>The ANOVA results show: Treatment had a significant effect on stem diameter, which differed significantly between treatment groups.</li>
<li>The LSD test indicates:
<ol type="1">
<li><strong>Treatment EXAm</strong> shows the highest stem diameter and is significantly better than Infes and Infes+Captan.</li>
<li>The <strong>Control group</strong> performs well and is comparable to EXAm.</li>
<li><strong>Infes</strong> has the lowest stem diameter, indicating it has the most detrimental effect on stem growth.</li>
<li>The combination treatment <strong>Infes+EXAm</strong> performs better than <strong>Infes+Captan</strong>, suggesting EXAm may be more effective than Captan in mitigating the negative effects of infestation.</li>
</ol></li>
<li>The Tukey HSD analysis further confirms:
<ol type="1">
<li><strong>EXAm</strong> consistently outperforms <strong>Infes</strong> and <strong>Infes+Captan</strong>, showing its significant positive effect on stem diameter.</li>
<li>The <strong>Control group</strong> is significantly better than <strong>Infes</strong> and may outperform <strong>Infes+Captan</strong> with weak evidence.</li>
<li><strong>Infes+EXAm</strong> shows potential improvement compared to <strong>Infes</strong>, but the difference is not statistically conclusive.</li>
<li><strong>Infes+Captan</strong> does not show a significant advantage over <strong>Infes</strong> alone.</li>
</ol></li>
<li>The normality tests demonstrate:
<ol type="1">
<li><strong>Stem Diameter</strong> and <strong>Root Dry Weight</strong> can be considered normally distributed, so ANOVA is appropriate for these variables.</li>
<li><strong>Aerial Dry Weight</strong> does not meet the assumption of normality, so the results of ANOVA may not be entirely reliable for this variable.</li>
</ol></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>